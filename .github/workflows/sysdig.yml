# https://docs.developer.gov.bc.ca/sysdig-monitor-setup-team/
name: Add Sysdig Team on a Schedule or Manually

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * *'

jobs:
    add-sysdig-team:
      runs-on: ubuntu-24.04
      environment: tools
      steps:
      - uses: actions/checkout@v4
      - name: Install OpenShift CLI
        run: |
          curl -LO https://mirror.openshift.com/pub/openshift-v4/clients/oc/latest/linux/oc.tar.gz
          tar -xzf oc.tar.gz
          sudo mv oc /usr/local/bin/
      - name: Add Sysdig Team
        run: |
          oc login --token=${{ secrets.oc_token }} --server=${{ vars.oc_server }}
          oc project db4642-tools # Safeguard!
          oc apply -f ./sysdig/sysdig.yml
        
